<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèõÔ∏è Alta C√∫pula - Sistema de Gest√£o RJ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0000 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .logo-rj {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text x="50" y="55" font-size="50" fill="%238B0000" text-anchor="middle" font-weight="bold">RJ</text></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }
        .card {
            background: rgba(10, 10, 10, 0.95);
            border: 1px solid rgba(139, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        .btn-primary {
            background: linear-gradient(135deg, #8B0000 0%, #a00000 100%);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(139, 0, 0, 0.4);
        }
        .stat-card {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.1) 0%, rgba(0, 0, 0, 0.3) 100%);
            border-left: 4px solid #8B0000;
        }
        .menu-item.active {
            background: linear-gradient(90deg, #8B0000 0%, transparent 100%);
            border-left: 4px solid #D4AF37;
        }
        @keyframes pulse-red {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-red {
            animation: pulse-red 2s ease-in-out infinite;
        }
    </style>
</head>
<body class="text-gray-100">

<div id="app"></div>

<script>
// ========================
// BANCO DE DADOS LOCAL
// ========================
const DB = {
    usuarios: JSON.parse(localStorage.getItem('ac_usuarios') || '[]'),
    faccoes: JSON.parse(localStorage.getItem('ac_faccoes') || '[]'),
    membros: JSON.parse(localStorage.getItem('ac_membros') || '[]'),
    operacoes: JSON.parse(localStorage.getItem('ac_operacoes') || '[]'),
    comunicados: JSON.parse(localStorage.getItem('ac_comunicados') || '[]'),
    decisoes: JSON.parse(localStorage.getItem('ac_decisoes') || '[]'),
    
    save() {
        localStorage.setItem('ac_usuarios', JSON.stringify(this.usuarios));
        localStorage.setItem('ac_faccoes', JSON.stringify(this.faccoes));
        localStorage.setItem('ac_membros', JSON.stringify(this.membros));
        localStorage.setItem('ac_operacoes', JSON.stringify(this.operacoes));
        localStorage.setItem('ac_comunicados', JSON.stringify(this.comunicados));
        localStorage.setItem('ac_decisoes', JSON.stringify(this.decisoes));
    },
    
    init() {
        // Criar usu√°rio admin padr√£o se n√£o existir
        if (this.usuarios.length === 0) {
            this.usuarios.push({
                id: 1,
                nome: 'Comando Supremo',
                apelido: 'Chefe',
                senha: 'senha123',
                cargo: 'Chefe',
                nivel: 5,
                status: 'Ativo'
            });
            this.save();
        }
    }
};

DB.init();

// ========================
// SISTEMA DE AUTENTICA√á√ÉO
// ========================
const Auth = {
    usuario: JSON.parse(localStorage.getItem('ac_user_logado') || 'null'),
    
    login(apelido, senha) {
        const user = DB.usuarios.find(u => u.apelido === apelido && u.senha === senha);
        if (user) {
            this.usuario = user;
            localStorage.setItem('ac_user_logado', JSON.stringify(user));
            return true;
        }
        return false;
    },
    
    logout() {
        this.usuario = null;
        localStorage.removeItem('ac_user_logado');
    },
    
    isLogado() {
        return this.usuario !== null;
    },
    
    isCupula() {
        return this.usuario && this.usuario.nivel >= 5;
    }
};

// ========================
// APLICA√á√ÉO
// ========================
class App {
    constructor() {
        this.paginaAtual = Auth.isLogado() ? 'dashboard' : 'login';
        this.render();
    }
    
    mudarPagina(pagina) {
        this.paginaAtual = pagina;
        this.render();
    }
    
    render() {
        const app = document.getElementById('app');
        
        if (!Auth.isLogado()) {
            app.innerHTML = this.renderLogin();
            this.attachLoginHandlers();
        } else {
            app.innerHTML = this.renderLayout();
            this.attachHandlers();
        }
    }
    
    renderLogin() {
        return `
            <div class="min-h-screen flex items-center justify-center p-4">
                <div class="card rounded-2xl p-8 w-full max-w-md shadow-2xl">
                    <div class="text-center mb-8">
                        <div class="w-24 h-24 mx-auto mb-4 rounded-full bg-gradient-to-br from-red-900 to-red-600 flex items-center justify-center shadow-lg">
                            <span class="text-4xl">üèõÔ∏è</span>
                        </div>
                        <h1 class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-yellow-500">
                            Alta C√∫pula
                        </h1>
                        <p class="text-gray-400 mt-2">Sistema de Gest√£o - Comando RJ</p>
                    </div>
                    
                    <form id="loginForm" class="space-y-6">
                        <div>
                            <label class="block text-gray-300 text-sm font-semibold mb-2">Apelido</label>
                            <input type="text" id="apelido" 
                                class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-3 focus:outline-none focus:border-red-600 focus:ring-2 focus:ring-red-600/20" 
                                placeholder="Digite seu apelido" required>
                        </div>
                        
                        <div>
                            <label class="block text-gray-300 text-sm font-semibold mb-2">Senha</label>
                            <input type="password" id="senha" 
                                class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-3 focus:outline-none focus:border-red-600 focus:ring-2 focus:ring-red-600/20" 
                                placeholder="Digite sua senha" required>
                        </div>
                        
                        <div id="loginErro" class="hidden bg-red-900/30 border border-red-600 text-red-200 px-4 py-3 rounded-lg text-sm"></div>
                        
                        <button type="submit" class="btn-primary w-full text-white font-bold py-3 px-6 rounded-lg shadow-lg">
                            üîì Acessar Sistema
                        </button>
                    </form>
                    
                    <div class="mt-6 p-4 bg-yellow-900/20 border border-yellow-600/30 rounded-lg">
                        <p class="text-yellow-200 text-xs text-center">
                            <strong>Acesso padr√£o:</strong><br>
                            Apelido: <code class="bg-black/30 px-2 py-1 rounded">Chefe</code> | 
                            Senha: <code class="bg-black/30 px-2 py-1 rounded">senha123</code>
                        </p>
                    </div>
                </div>
            </div>
        `;
    }
    
    renderLayout() {
        return `
            <div class="flex flex-col md:flex-row min-h-screen">
                <!-- Sidebar -->
                <div class="w-full md:w-64 bg-black/80 border-r border-red-900/30 md:min-h-screen">
                    ${this.renderSidebar()}
                </div>
                
                <!-- Conte√∫do -->
                <div class="flex-1 p-4 md:p-8">
                    ${this.renderConteudo()}
                </div>
            </div>
        `;
    }
    
    renderSidebar() {
        const menus = [
            { id: 'dashboard', icon: 'üèõÔ∏è', label: 'Dashboard', nivel: 1 },
            { id: 'faccoes', icon: 'üè¥', label: 'Fac√ß√µes', nivel: 1 },
            { id: 'membros', icon: 'üë•', label: 'Membros', nivel: 3 },
            { id: 'operacoes', icon: 'üíÄ', label: 'Opera√ß√µes', nivel: 3 },
            { id: 'inteligencia', icon: 'üïµÔ∏è', label: 'Intelig√™ncia', nivel: 4 },
            { id: 'comunicados', icon: 'üì¢', label: 'Comunicados', nivel: 1 },
            { id: 'cupula', icon: 'üëë', label: 'Alta C√∫pula', nivel: 5 }
        ];
        
        const menusFiltrados = menus.filter(m => Auth.usuario.nivel >= m.nivel);
        
        return `
            <div class="p-6 border-b border-red-900/30">
                <h2 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-yellow-500">
                    üèõÔ∏è Alta C√∫pula
                </h2>
                <p class="text-xs text-gray-500 mt-1">Comando RJ</p>
            </div>
            
            <div class="p-4 border-b border-red-900/30">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-red-600 to-red-800 rounded-full flex items-center justify-center font-bold shadow-lg">
                        ${Auth.usuario.apelido[0].toUpperCase()}
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-semibold truncate">${Auth.usuario.apelido}</p>
                        <p class="text-xs text-gray-400">${Auth.usuario.cargo}</p>
                    </div>
                </div>
            </div>
            
            <nav class="p-4 space-y-2">
                ${menusFiltrados.map(m => `
                    <button onclick="app.mudarPagina('${m.id}')" 
                        class="menu-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition ${this.paginaAtual === m.id ? 'active' : 'hover:bg-red-900/20'}">
                        <span class="text-xl">${m.icon}</span>
                        <span class="font-medium">${m.label}</span>
                    </button>
                `).join('')}
            </nav>
            
            <div class="absolute bottom-0 w-full md:w-64 p-4 border-t border-red-900/30">
                <button onclick="app.sair()" class="w-full bg-red-900/30 hover:bg-red-900/50 text-red-200 font-semibold py-2 px-4 rounded-lg transition">
                    üö™ Sair
                </button>
            </div>
        `;
    }
    
    renderConteudo() {
        switch(this.paginaAtual) {
            case 'dashboard': return this.renderDashboard();
            case 'faccoes': return this.renderFaccoes();
            case 'membros': return this.renderMembros();
            case 'operacoes': return this.renderOperacoes();
            case 'inteligencia': return this.renderInteligencia();
            case 'comunicados': return this.renderComunicados();
            case 'cupula': return this.renderCupula();
            default: return this.renderDashboard();
        }
    }
    
    renderDashboard() {
        const stats = {
            faccoes: DB.faccoes.filter(f => f.status === 'Ativa').length,
            membros: DB.membros.filter(m => m.status === 'Ativo').length,
            operacoes: DB.operacoes.filter(o => o.status === 'Em Andamento').length,
            comunicados: DB.comunicados.filter(c => c.prioridade === 'Urgente').length
        };
        
        return `
            <div class="mb-8">
                <h1 class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-yellow-500">
                    Bem-vindo, ${Auth.usuario.apelido}
                </h1>
                <p class="text-gray-400 mt-2">${Auth.usuario.cargo} ‚Ä¢ ${new Date().toLocaleDateString('pt-BR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                ${this.renderStatCard('üè¥', 'Fac√ß√µes Ativas', stats.faccoes, 'from-yellow-600 to-yellow-800')}
                ${this.renderStatCard('üë•', 'Membros Ativos', stats.membros, 'from-green-600 to-green-800')}
                ${this.renderStatCard('üíÄ', 'Opera√ß√µes Ativas', stats.operacoes, 'from-red-600 to-red-800')}
                ${this.renderStatCard('üì¢', 'Alertas Urgentes', stats.comunicados, 'from-orange-600 to-orange-800')}
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-bold text-red-500 mb-4">üìä Status do Sistema</h2>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-3 border-b border-gray-800">
                            <span class="text-gray-400">Status Operacional</span>
                            <span class="text-green-500 font-semibold flex items-center">
                                <span class="w-2 h-2 bg-green-500 rounded-full mr-2 pulse-red"></span>
                                Online
                            </span>
                        </div>
                        <div class="flex justify-between items-center py-3 border-b border-gray-800">
                            <span class="text-gray-400">Seu N√≠vel de Acesso</span>
                            <span class="text-yellow-500 font-bold">${Auth.usuario.nivel}/5</span>
                        </div>
                        <div class="flex justify-between items-center py-3">
                            <span class="text-gray-400">Total de Usu√°rios</span>
                            <span class="text-white font-semibold">${DB.usuarios.length}</span>
                        </div>
                    </div>
                </div>
                
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-bold text-red-500 mb-4">‚ö° A√ß√µes R√°pidas</h2>
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="app.mudarPagina('comunicados')" class="bg-gradient-to-br from-red-900/30 to-black/50 hover:from-red-800/40 hover:to-black/60 border border-red-800/30 p-4 rounded-lg transition text-left">
                            <div class="text-2xl mb-2">üì¢</div>
                            <div class="text-sm font-semibold">Ver Comunicados</div>
                        </button>
                        <button onclick="app.mudarPagina('faccoes')" class="bg-gradient-to-br from-red-900/30 to-black/50 hover:from-red-800/40 hover:to-black/60 border border-red-800/30 p-4 rounded-lg transition text-left">
                            <div class="text-2xl mb-2">üè¥</div>
                            <div class="text-sm font-semibold">Ver Fac√ß√µes</div>
                        </button>
                        <button onclick="app.mudarPagina('operacoes')" class="bg-gradient-to-br from-red-900/30 to-black/50 hover:from-red-800/40 hover:to-black/60 border border-red-800/30 p-4 rounded-lg transition text-left">
                            <div class="text-2xl mb-2">üíÄ</div>
                            <div class="text-sm font-semibold">Ver Opera√ß√µes</div>
                        </button>
                        <button onclick="app.mudarPagina('membros')" class="bg-gradient-to-br from-red-900/30 to-black/50 hover:from-red-800/40 hover:to-black/60 border border-red-800/30 p-4 rounded-lg transition text-left">
                            <div class="text-2xl mb-2">üë•</div>
                            <div class="text-sm font-semibold">Ver Membros</div>
                        </button>
                    </div>
                </div>
            </div>
        `;
    }
    
    renderStatCard(icon, titulo, valor, gradient) {
        return `
            <div class="stat-card card rounded-xl p-6 hover:scale-105 transition-transform cursor-pointer">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-400 text-sm mb-1">${titulo}</p>
                        <p class="text-3xl font-bold bg-gradient-to-r ${gradient} text-transparent bg-clip-text">${valor}</p>
                    </div>
                    <div class="text-5xl opacity-20">${icon}</div>
                </div>
            </div>
        `;
    }
    
    renderFaccoes() {
        return `
            <div class="mb-6">
                <h1 class="text-3xl font-bold text-red-500 mb-2">üè¥ Fac√ß√µes</h1>
                <p class="text-gray-400">Gerenciamento de fac√ß√µes e territ√≥rios</p>
            </div>
            
            ${Auth.usuario.nivel >= 4 ? `
                <button onclick="app.modalNovaFaccao()" class="btn-primary mb-6 px-6 py-3 rounded-lg font-semibold shadow-lg">
                    ‚ûï Nova Fac√ß√£o
                </button>
            ` : ''}
            
            ${DB.faccoes.length === 0 ? `
                <div class="card rounded-xl p-8 text-center">
                    <div class="text-6xl mb-4">üè¥</div>
                    <p class="text-gray-400">Nenhuma fac√ß√£o cadastrada ainda.</p>
                </div>
            ` : `
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    ${DB.faccoes.map(f => `
                        <div class="card rounded-xl p-6 hover:border-red-600 transition">
                            <div class="flex items-start justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold text-white">${f.nome}</h3>
                                    <p class="text-sm text-gray-400">${f.sigla}</p>
                                </div>
                                <span class="px-3 py-1 rounded-full text-xs font-semibold ${f.status === 'Ativa' ? 'bg-green-900/30 text-green-400' : 'bg-gray-700 text-gray-400'}">
                                    ${f.status}
                                </span>
                            </div>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Territ√≥rios:</span>
                                    <span class="text-white font-semibold">${f.territorios || 0}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Membros:</span>
                                    <span class="text-white font-semibold">${f.membros || 0}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Influ√™ncia:</span>
                                    <span class="text-yellow-500 font-semibold">${f.influencia || 0}%</span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `}
        `;
    }
    
    renderMembros() {
        return `
            <div class="mb-6">
                <h1 class="text-3xl font-bold text-red-500 mb-2">üë• Membros</h1>
                <p class="text-gray-400">Gest√£o de membros da organiza√ß√£o</p>
            </div>
            
            <button onclick="app.modalNovoMembro()" class="btn-primary mb-6 px-6 py-3 rounded-lg font-semibold shadow-lg">
                ‚ûï Novo Membro
            </button>
            
            ${DB.membros.length === 0 ? `
                <div class="card rounded-xl p-8 text-center">
                    <div class="text-6xl mb-4">üë•</div>
                    <p class="text-gray-400">Nenhum membro cadastrado.</p>
                </div>
            ` : `
                <div class="card rounded-xl overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-red-900/20">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase">Cargo</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase">Lealdade</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase">Status</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-800">
                                ${DB.membros.map(m => `
                                    <tr class="hover:bg-red-900/10 transition">
                                        <td class="px-6 py-4 text-white font-medium">${m.nome}</td>
                                        <td class="px-6 py-4 text-gray-300">${m.cargo}</td>
                                        <td class="px-6 py-4">
                                            <div class="flex items-center space-x-2">
                                                <div class="w-24 bg-gray-800 rounded-full h-2">
                                                    <div class="bg-gradient-to-r from-red-600 to-green-600 h-2 rounded-full" style="width: ${m.lealdade || 50}%"></div>
                                                </div>
                                                <span class="text-sm text-gray-400">${m.lealdade || 50}%</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4">
                                            <span class="px-2 py-1 rounded-full text-xs font-semibold ${m.status === 'Ativo' ? 'bg-green-900/30 text-green-400' : 'bg-gray-700 text-gray-400'}">
                                                ${m.status}
                                            </span>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `}
        `;
    }
    
    renderOperacoes() {
        return `
            <div class="mb-6">
                <h1 class="text-3xl font-bold text-red-500 mb-2">üíÄ Opera√ß√µes</h1>
                <p class="text-gray-400">Planejamento e execu√ß√£o de opera√ß√µes</p>
            </div>
            
            <button onclick="app.modalNovaOperacao()" class="btn-primary mb-6 px-6 py-3 rounded-lg font-semibold shadow-lg">
                ‚ûï Nova Opera√ß√£o
            </button>
            
            ${DB.operacoes.length === 0 ? `
                <div class="card rounded-xl p-8 text-center">
                    <div class="text-6xl mb-4">üíÄ</div>
                    <p class="text-gray-400">Nenhuma opera√ß√£o planejada.</p>
                </div>
            ` : `
                <div class="space-y-4">
                    ${DB.operacoes.map(o => `
                        <div class="card rounded-xl p-6 hover:border-red-600 transition">
                            <div class="flex items-start justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold text-white">${o.titulo}</h3>
                                    <p class="text-sm text-gray-400">${o.tipo} ‚Ä¢ ${o.codigo}</p>
                                </div>
                                <span class="px-3 py-1 rounded-full text-xs font-semibold ${
                                    o.status === 'Conclu√≠da' ? 'bg-green-900/30 text-green-400' :
                                    o.status === 'Em Andamento' ? 'bg-yellow-900/30 text-yellow-400' :
                                    o.status === 'Falhada' ? 'bg-red-900/30 text-red-400' :
                                    'bg-gray-700 text-gray-400'
                                }">
                                    ${o.status}
                                </span>
                            </div>
                            <p class="text-gray-300 mb-4">${o.descricao}</p>
                            <div class="flex items-center justify-between text-sm">
                                <span class="text-gray-400">Prioridade: <span class="text-${o.prioridade === 'Cr√≠tica' ? 'red' : o.prioridade === 'Alta' ? 'orange' : 'yellow'}-500 font-semibold">${o.prioridade}</span></span>
                                <span class="text-gray-400">${new Date(o.data).toLocaleDateString('pt-BR')}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `}
        `;
    }
    
    renderInteligencia() {
        return `
            <div class="mb-6">
                <h1 class="text-3xl font-bold text-red-500 mb-2">üïµÔ∏è Intelig√™ncia</h1>
                <p class="text-gray-400">Central de informa√ß√µes e contraintelig√™ncia</p>
            </div>
            
            <div class="card rounded-xl p-8 text-center">
                <div class="text-6xl mb-4">üïµÔ∏è</div>
                <p class="text-gray-400 mb-4">M√≥dulo de Intelig√™ncia</p>
                <p class="text-sm text-gray-500">Sistema de informantes, alvos e an√°lises em desenvolvimento.</p>
            </div>
        `;
    }
    
    renderComunicados() {
        return `
            <div class="mb-6">
                <h1 class="text-3xl font-bold text-red-500 mb-2">üì¢ Comunicados</h1>
                <p class="text-gray-400">Avisos e ordens internas</p>
            </div>
            
            ${Auth.usuario.nivel >= 3 ? `
                <button onclick="app.modalNovoComunicado()" class="btn-primary mb-6 px-6 py-3 rounded-lg font-semibold shadow-lg">
                    ‚ûï Novo Comunicado
                </button>
            ` : ''}
            
            ${DB.comunicados.length === 0 ? `
                <div class="card rounded-xl p-8 text-center">
                    <div class="text-6xl mb-4">üì¢</div>
                    <p class="text-gray-400">Nenhum comunicado no momento.</p>
                </div>
            ` : `
                <div class="space-y-4">
                    ${DB.comunicados.map(c => `
                        <div class="card rounded-xl p-6 ${c.fixado ? 'border-yellow-600' : ''}">
                            ${c.fixado ? '<div class="text-yellow-500 text-xs font-semibold mb-2">üìå FIXADO</div>' : ''}
                            <div class="flex items-start justify-between mb-3">
                                <h3 class="text-lg font-bold text-white">${c.titulo}</h3>
                                <span class="px-3 py-1 rounded-full text-xs font-semibold ${
                                    c.prioridade === 'Cr√≠tico' ? 'bg-red-900/30 text-red-400' :
                                    c.prioridade === 'Urgente' ? 'bg-orange-900/30 text-orange-400' :
                                    c.prioridade === 'Importante' ? 'bg-yellow-900/30 text-yellow-400' :
                                    'bg-gray-700 text-gray-400'
                                }">
                                    ${c.prioridade}
                                </span>
                            </div>
                            <p class="text-gray-300 mb-3">${c.conteudo}</p>
                            <div class="flex items-center justify-between text-xs text-gray-500">
                                <span>Por: ${c.autor}</span>
                                <span>${new Date(c.data).toLocaleString('pt-BR')}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `}
        `;
    }
    
    renderCupula() {
        return `
            <div class="mb-6">
                <h1 class="text-3xl font-bold text-red-500 mb-2">üëë Alta C√∫pula</h1>
                <p class="text-gray-400">Decis√µes e gest√£o da lideran√ßa</p>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-bold text-yellow-500 mb-4">üëë Membros da C√∫pula</h2>
                    <div class="space-y-3">
                        ${DB.usuarios.filter(u => u.nivel >= 5).map(u => `
                            <div class="flex items-center space-x-3 p-3 bg-red-900/10 rounded-lg">
                                <div class="w-10 h-10 bg-gradient-to-br from-yellow-600 to-yellow-800 rounded-full flex items-center justify-center font-bold">
                                    ${u.apelido[0].toUpperCase()}
                                </div>
                                <div>
                                    <p class="font-semibold text-white">${u.nome}</p>
                                    <p class="text-xs text-gray-400">${u.cargo}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-bold text-yellow-500 mb-4">‚öñÔ∏è √öltima Decis√£o</h2>
                    ${DB.decisoes.length > 0 ? `
                        <div class="bg-red-900/10 rounded-lg p-4">
                            <h3 class="font-bold text-white mb-2">${DB.decisoes[DB.decisoes.length - 1].titulo}</h3>
                            <p class="text-sm text-gray-300 mb-3">${DB.decisoes[DB.decisoes.length - 1].descricao}</p>
                            <div class="flex justify-between text-xs text-gray-400">
                                <span>Status: ${DB.decisoes[DB.decisoes.length - 1].status}</span>
                                <span>${new Date(DB.decisoes[DB.decisoes.length - 1].data).toLocaleDateString('pt-BR')}</span>
                            </div>
                        </div>
                    ` : `
                        <p class="text-gray-400">Nenhuma decis√£o registrada.</p>
                    `}
                </div>
            </div>
            
            <button onclick="app.modalNovaDecisao()" class="btn-primary px-6 py-3 rounded-lg font-semibold shadow-lg">
                ‚ûï Nova Decis√£o
            </button>
        `;
    }
    
    // Modais
    modalNovaFaccao() {
        const modal = `
            <div id="modal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" onclick="if(event.target.id==='modal') this.remove()">
                <div class="card rounded-xl p-6 w-full max-w-md" onclick="event.stopPropagation()">
                    <h2 class="text-2xl font-bold text-red-500 mb-4">üè¥ Nova Fac√ß√£o</h2>
                    <form id="formFaccao" class="space-y-4">
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Nome</label>
                            <input type="text" name="nome" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Sigla</label>
                            <input type="text" name="sigla" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Territ√≥rios</label>
                            <input type="number" name="territorios" value="0" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2">
                        </div>
                        <div class="flex space-x-3">
                            <button type="submit" class="btn-primary flex-1 py-2 rounded-lg font-semibold">Criar</button>
                            <button type="button" onclick="document.getElementById('modal').remove()" class="bg-gray-700 hover:bg-gray-600 flex-1 text-white py-2 rounded-lg font-semibold">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modal);
        document.getElementById('formFaccao').onsubmit = (e) => {
            e.preventDefault();
            const data = new FormData(e.target);
            DB.faccoes.push({
                id: Date.now(),
                nome: data.get('nome'),
                sigla: data.get('sigla'),
                territorios: parseInt(data.get('territorios')),
                membros: 0,
                influencia: 0,
                status: 'Ativa'
            });
            DB.save();
            document.getElementById('modal').remove();
            this.render();
        };
    }
    
    modalNovoMembro() {
        const modal = `
            <div id="modal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" onclick="if(event.target.id==='modal') this.remove()">
                <div class="card rounded-xl p-6 w-full max-w-md" onclick="event.stopPropagation()">
                    <h2 class="text-2xl font-bold text-red-500 mb-4">üë• Novo Membro</h2>
                    <form id="formMembro" class="space-y-4">
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Nome</label>
                            <input type="text" name="nome" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Cargo</label>
                            <select name="cargo" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2">
                                <option>Soldado</option>
                                <option>Vapor</option>
                                <option>Gerente</option>
                                <option>Dono</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Lealdade (%)</label>
                            <input type="number" name="lealdade" value="50" min="0" max="100" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2">
                        </div>
                        <div class="flex space-x-3">
                            <button type="submit" class="btn-primary flex-1 py-2 rounded-lg font-semibold">Adicionar</button>
                            <button type="button" onclick="document.getElementById('modal').remove()" class="bg-gray-700 hover:bg-gray-600 flex-1 text-white py-2 rounded-lg font-semibold">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modal);
        document.getElementById('formMembro').onsubmit = (e) => {
            e.preventDefault();
            const data = new FormData(e.target);
            DB.membros.push({
                id: Date.now(),
                nome: data.get('nome'),
                cargo: data.get('cargo'),
                lealdade: parseInt(data.get('lealdade')),
                status: 'Ativo'
            });
            DB.save();
            document.getElementById('modal').remove();
            this.render();
        };
    }
    
    modalNovaOperacao() {
        const modal = `
            <div id="modal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" onclick="if(event.target.id==='modal') this.remove()">
                <div class="card rounded-xl p-6 w-full max-w-md" onclick="event.stopPropagation()">
                    <h2 class="text-2xl font-bold text-red-500 mb-4">üíÄ Nova Opera√ß√£o</h2>
                    <form id="formOperacao" class="space-y-4">
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">T√≠tulo</label>
                            <input type="text" name="titulo" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">C√≥digo</label>
                            <input type="text" name="codigo" placeholder="Ex: OP-001" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Tipo</label>
                            <select name="tipo" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2">
                                <option>Expans√£o</option>
                                <option>Defesa</option>
                                <option>Resgate</option>
                                <option>Acerto</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Prioridade</label>
                            <select name="prioridade" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2">
                                <option>Baixa</option>
                                <option>M√©dia</option>
                                <option>Alta</option>
                                <option>Cr√≠tica</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Descri√ß√£o</label>
                            <textarea name="descricao" rows="3" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required></textarea>
                        </div>
                        <div class="flex space-x-3">
                            <button type="submit" class="btn-primary flex-1 py-2 rounded-lg font-semibold">Criar</button>
                            <button type="button" onclick="document.getElementById('modal').remove()" class="bg-gray-700 hover:bg-gray-600 flex-1 text-white py-2 rounded-lg font-semibold">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modal);
        document.getElementById('formOperacao').onsubmit = (e) => {
            e.preventDefault();
            const data = new FormData(e.target);
            DB.operacoes.push({
                id: Date.now(),
                titulo: data.get('titulo'),
                codigo: data.get('codigo'),
                tipo: data.get('tipo'),
                prioridade: data.get('prioridade'),
                descricao: data.get('descricao'),
                status: 'Planejando',
                data: new Date().toISOString()
            });
            DB.save();
            document.getElementById('modal').remove();
            this.render();
        };
    }
    
    modalNovoComunicado() {
        const modal = `
            <div id="modal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" onclick="if(event.target.id==='modal') this.remove()">
                <div class="card rounded-xl p-6 w-full max-w-md" onclick="event.stopPropagation()">
                    <h2 class="text-2xl font-bold text-red-500 mb-4">üì¢ Novo Comunicado</h2>
                    <form id="formComunicado" class="space-y-4">
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">T√≠tulo</label>
                            <input type="text" name="titulo" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Prioridade</label>
                            <select name="prioridade" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2">
                                <option>Normal</option>
                                <option>Importante</option>
                                <option>Urgente</option>
                                <option>Cr√≠tico</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Conte√∫do</label>
                            <textarea name="conteudo" rows="4" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required></textarea>
                        </div>
                        <div>
                            <label class="flex items-center space-x-2 text-gray-300">
                                <input type="checkbox" name="fixado" class="rounded">
                                <span class="text-sm">Fixar comunicado</span>
                            </label>
                        </div>
                        <div class="flex space-x-3">
                            <button type="submit" class="btn-primary flex-1 py-2 rounded-lg font-semibold">Publicar</button>
                            <button type="button" onclick="document.getElementById('modal').remove()" class="bg-gray-700 hover:bg-gray-600 flex-1 text-white py-2 rounded-lg font-semibold">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modal);
        document.getElementById('formComunicado').onsubmit = (e) => {
            e.preventDefault();
            const data = new FormData(e.target);
            DB.comunicados.push({
                id: Date.now(),
                titulo: data.get('titulo'),
                prioridade: data.get('prioridade'),
                conteudo: data.get('conteudo'),
                fixado: data.get('fixado') === 'on',
                autor: Auth.usuario.apelido,
                data: new Date().toISOString()
            });
            DB.save();
            document.getElementById('modal').remove();
            this.render();
        };
    }
    
    modalNovaDecisao() {
        const modal = `
            <div id="modal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" onclick="if(event.target.id==='modal') this.remove()">
                <div class="card rounded-xl p-6 w-full max-w-md" onclick="event.stopPropagation()">
                    <h2 class="text-2xl font-bold text-red-500 mb-4">üëë Nova Decis√£o</h2>
                    <form id="formDecisao" class="space-y-4">
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">T√≠tulo</label>
                            <input type="text" name="titulo" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Tipo</label>
                            <select name="tipo" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2">
                                <option>Lei Interna</option>
                                <option>Ordem</option>
                                <option>Alian√ßa</option>
                                <option>Puni√ß√£o</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-300 text-sm mb-2">Descri√ß√£o</label>
                            <textarea name="descricao" rows="4" class="w-full bg-black/50 border border-red-900/50 text-white rounded-lg px-4 py-2" required></textarea>
                        </div>
                        <div class="flex space-x-3">
                            <button type="submit" class="btn-primary flex-1 py-2 rounded-lg font-semibold">Registrar</button>
                            <button type="button" onclick="document.getElementById('modal').remove()" class="bg-gray-700 hover:bg-gray-600 flex-1 text-white py-2 rounded-lg font-semibold">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modal);
        document.getElementById('formDecisao').onsubmit = (e) => {
            e.preventDefault();
            const data = new FormData(e.target);
            DB.decisoes.push({
                id: Date.now(),
                titulo: data.get('titulo'),
                tipo: data.get('tipo'),
                descricao: data.get('descricao'),
                status: 'Aprovada',
                autor: Auth.usuario.apelido,
                data: new Date().toISOString()
            });
            DB.save();
            document.getElementById('modal').remove();
            this.render();
        };
    }
    
    attachLoginHandlers() {
        document.getElementById('loginForm').onsubmit = (e) => {
            e.preventDefault();
            const apelido = document.getElementById('apelido').value;
            const senha = document.getElementById('senha').value;
            const erro = document.getElementById('loginErro');
            
            if (Auth.login(apelido, senha)) {
                this.paginaAtual = 'dashboard';
                this.render();
            } else {
                erro.textContent = 'Credenciais inv√°lidas. Tente novamente.';
                erro.classList.remove('hidden');
            }
        };
    }
    
    attachHandlers() {
        // Handlers s√£o anexados via onclick inline nos bot√µes
    }
    
    sair() {
        Auth.logout();
        this.paginaAtual = 'login';
        this.render();
    }
}

// Iniciar aplica√ß√£o
const app = new App();
</script>

</body>
</html>
